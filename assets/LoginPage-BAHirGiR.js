import{X as le,W as ce,aU as q,a8 as ue,Y as de,T as w,Z as G,_ as $,a as I,$ as pe,a0 as fe,aV as he,aa as me,j as n,a1 as ge,a2 as xe,c as C,B as f,o as J,aW as K,aQ as ye,aL as R,n as ve,E as be,u as Ce,aX as je,q as De,aY as ke,aZ as Ie,a_ as we,a$ as Se,b0 as Le,b1 as Pe,b2 as Te}from"./index-BcecFl1Z.js";import{F as Ve}from"./formik.esm-BY6TlLsT.js";import{c as Fe,b as Ae}from"./index.esm-D49cUJoZ.js";import{C as X}from"./CustomButtons-2kTcvzb6.js";import{P as H}from"./index-WftMIkCS.js";import{s as Be}from"./HelperFunctions-DWwEU7oF.js";import{a as U}from"./index-Cj_J1U08.js";function Re(t){return ce("MuiLink",t)}const Oe=le("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),Q={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},_e=t=>Q[t]||t,We=({theme:t,ownerState:a})=>{const u=_e(a.color),s=q(t,`palette.${u}`,!1)||a.color,i=q(t,`palette.${u}Channel`);return"vars"in t&&i?`rgba(${i} / 0.4)`:ue(s,.4)},Ee=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],Ne=t=>{const{classes:a,component:u,focusVisible:s,underline:i}=t,r={root:["root",`underline${G(i)}`,u==="button"&&"button",s&&"focusVisible"]};return xe(r,Re,a)},$e=de(w,{name:"MuiLink",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:u}=t;return[a.root,a[`underline${G(u.underline)}`],u.component==="button"&&a.button]}})(({theme:t,ownerState:a})=>$({},a.underline==="none"&&{textDecoration:"none"},a.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},a.underline==="always"&&$({textDecoration:"underline"},a.color!=="inherit"&&{textDecorationColor:We({theme:t,ownerState:a})},{"&:hover":{textDecorationColor:"inherit"}}),a.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Oe.focusVisible}`]:{outline:"auto"}})),M=I.forwardRef(function(a,u){const s=pe({props:a,name:"MuiLink"}),{className:i,color:r="primary",component:c="a",onBlur:l,onFocus:g,TypographyClasses:v,underline:j="always",variant:x="inherit",sx:p}=s,S=fe(s,Ee),{isFocusVisibleRef:D,onBlur:L,onFocus:A,ref:O}=he(),[B,h]=I.useState(!1),V=me(u,O),b=P=>{L(P),D.current===!1&&h(!1),l&&l(P)},d=P=>{A(P),D.current===!0&&h(!0),g&&g(P)},k=$({},s,{color:r,component:c,focusVisible:B,underline:j,variant:x}),_=Ne(k);return n.jsx($e,$({color:r,className:ge(_.root,i),classes:v,component:c,onBlur:b,onFocus:d,ref:V,ownerState:k,variant:x,sx:[...Object.keys(Q).includes(r)?[]:[{color:r}],...Array.isArray(p)?p:[p]]},S))}),ze="/assets/login_frame-DJxbL3HA.svg",He="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%3e%3cg%20clip-path='url(%23clip0_84_13782)'%3e%3cpath%20d='M12.75%202.24998C12.947%202.053%2013.1808%201.89674%2013.4382%201.79014C13.6956%201.68353%2013.9714%201.62866%2014.25%201.62866C14.5286%201.62866%2014.8044%201.68353%2015.0618%201.79014C15.3192%201.89674%2015.553%202.053%2015.75%202.24998C15.947%202.44697%2016.1032%202.68082%2016.2098%202.93819C16.3164%203.19556%2016.3713%203.47141%2016.3713%203.74998C16.3713%204.02856%2016.3164%204.30441%2016.2098%204.56178C16.1032%204.81915%2015.947%205.053%2015.75%205.24998L5.625%2015.375L1.5%2016.5L2.625%2012.375L12.75%202.24998Z'%20stroke='%2361B1EB'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M1%2017H14'%20stroke='%2361B1EB'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_84_13782'%3e%3crect%20width='18'%20height='18'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",Me="/assets/gisi-login-logo-DC5zeJMb.svg",Y={mainContainer:{bgcolor:C.white,height:"100%",width:"100%",position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},loginImgCss:{position:"absolute",top:0,left:0}},qe=({children:t})=>n.jsxs(f,{sx:{...J.centerDivCss,...Y.mainContainer},children:[n.jsx(f,{component:"img",src:ze,sx:{...Y.loginImgCss,display:{xs:"none",md:"block"}}}),n.jsxs(f,{height:{xs:"95%",md:"90%"},width:"80%",zIndex:10,children:[n.jsx(f,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{mt:3},children:n.jsx(f,{component:"img",src:Me,mt:1})}),n.jsx(f,{height:"auto",children:t})]}),n.jsxs(w,{variant:"body2",sx:{textAlign:"center"},children:["Click “Continue” to agree to our"," ",n.jsx(M,{href:"/terms-of-service",sx:{color:C.orange1,textDecoration:"none"},children:"Terms of Service"})," ","and you agree that"," ",n.jsx(M,{href:"/privacy-policy",sx:{color:C.orange1,textDecoration:"none"},children:"Privacy Policy"})," ","applies to you."]})]}),W={mainContainer:{height:"100vh",width:"100%",bgcolor:C.gray8},subContainer:{height:"100%",width:"100%",maxWidth:{xs:"100%",md:"1200px"},mx:"auto"},wrapper:{height:"100%",width:"100%",maxWidth:{xs:"100%",md:"733px"},maxHeight:"100%",display:"flex",justifyContent:"center",alignItems:"center"},continueBtn:{width:"100%",height:"44px",background:C.black1,fontSize:"18px",fontFamily:"Chivo",fontWeight:700,":hover":{bgcolor:C.black1}}},Ue=Fe({email:Ae().email("Invalid email address").required("Email is required")}),Ye=({email:t,setEmail:a,setIsVerificationPage:u})=>{const[s,i]=I.useState(!1);return n.jsx(Ve,{initialValues:{email:t},validationSchema:Ue,onSubmit:async(r,{setFieldError:c})=>{var l,g,v,j,x;try{i(!0);const p=await K({emailId:r.email});((l=p==null?void 0:p.data)==null?void 0:l.status_code)===200&&(a(r.email),u(!0),i(!1))}catch(p){((v=(g=p==null?void 0:p.response)==null?void 0:g.data)==null?void 0:v.status_code)===404&&c("email",(x=(j=p==null?void 0:p.response)==null?void 0:j.data)==null?void 0:x.data),i(!1)}},children:({values:r,errors:c,touched:l,handleChange:g,handleSubmit:v})=>n.jsxs(f,{component:"form",onSubmit:v,sx:{display:"flex",flexDirection:"column",gap:2,mt:4},children:[n.jsx(ye,{value:r.email,onChange:g("email"),label:"Email",placeholder:"Type here..",sx:{bgcolor:C.gray},error:l.email&&!!c.email}),l.email&&c.email&&n.jsx(w,{variant:"body2",color:"error",lineHeight:"0px",children:c.email}),n.jsx(X,{title:s?"Loading...":"Continue",size:"large",sx:W.continueBtn,disabled:s,type:"submit"})]})})};var Z=function(t){return typeof t=="object"&&t!==null},Ze=function(t){var a=t.value,u=a===void 0?"":a,s=t.numInputs,i=s===void 0?4:s,r=t.onChange,c=t.onPaste,l=t.renderInput,g=t.shouldAutoFocus,v=g===void 0?!1:g,j=t.inputType,x=j===void 0?"text":j,p=t.renderSeparator,S=t.placeholder,D=t.containerStyle,L=t.inputStyle,A=t.skipDefaultStyles,O=A===void 0?!1:A,B=R.useState(0),h=B[0],V=B[1],b=R.useRef([]),d=function(){return u?u.toString().split(""):[]},k=x==="number"||x==="tel";R.useEffect(function(){b.current=b.current.slice(0,i)},[i]),R.useEffect(function(){var e;v&&((e=b.current[0])===null||e===void 0||e.focus())},[v]);var _=function(){if(typeof S=="string"){if(S.length===i)return S;S.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}},P=function(e){var o=k?!isNaN(Number(e)):typeof e=="string";return o&&e.trim().length===1},te=function(e){var o=e.target.value;P(o)&&(E(o),F(h+1))},ne=function(e){var o=e.nativeEvent,m=e.target.value;if(!P(m)){if(m.length===i){var y=m.split("").some(function(T){return!P(T)});y||(z(m.split("")),F(i-1))}o.data===null&&o.inputType==="deleteContentBackward"&&(e.preventDefault(),E(""),F(h-1)),e.target.value=""}},ae=function(e){return function(o){V(o),e.target.select()}},oe=function(){V(h-1)},ie=function(e){var o=d();[e.code,e.key].includes("Backspace")?(e.preventDefault(),E(""),F(h-1)):e.code==="Delete"?(e.preventDefault(),E("")):e.code==="ArrowLeft"?(e.preventDefault(),F(h-1)):e.code==="ArrowRight"||e.key===o[h]?(e.preventDefault(),F(h+1)):(e.code==="Spacebar"||e.code==="Space"||e.code==="ArrowUp"||e.code==="ArrowDown")&&e.preventDefault()},F=function(e){var o,m,y=Math.max(Math.min(i-1,e),0);b.current[y]&&((o=b.current[y])===null||o===void 0||o.focus(),(m=b.current[y])===null||m===void 0||m.select(),V(y))},E=function(e){var o=d();o[h]=e[0],z(o)},z=function(e){var o=e.join("");r(o)},re=function(e){var o;e.preventDefault();var m=d(),y=h,T=e.clipboardData.getData("text/plain").slice(0,i-h).split("");if(!(k&&T.some(function(se){return isNaN(Number(se))}))){for(var N=0;N<i;++N)N>=h&&T.length>0&&(m[N]=(o=T.shift())!==null&&o!==void 0?o:"",y++);F(y),z(m)}};return R.createElement("div",{style:Object.assign({display:"flex",alignItems:"center"},Z(D)&&D),className:typeof D=="string"?D:void 0,onPaste:c},Array.from({length:i},function(e,o){return o}).map(function(e){var o,m,y;return R.createElement(R.Fragment,{key:e},l({value:(o=d()[e])!==null&&o!==void 0?o:"",placeholder:(y=(m=_())===null||m===void 0?void 0:m[e])!==null&&y!==void 0?y:void 0,ref:function(T){return b.current[e]=T},onChange:te,onFocus:function(T){return ae(T)(e)},onBlur:oe,onKeyDown:ie,onPaste:re,autoComplete:"off","aria-label":"Please enter OTP character ".concat(e+1),style:Object.assign(O?{}:{width:"1em",textAlign:"center"},Z(L)?L:{}),className:typeof L=="string"?L:void 0,type:x,inputMode:k?"numeric":"text",onInput:ne},e),e<i-1&&(typeof p=="function"?p(e):p))}))};const ee=({otp:t,setOtp:a,numInputs:u=4,setOtpErrorMessage:s})=>{const i=r=>{/^\d*$/.test(r)&&(s(""),a(r))};return n.jsx(Ze,{value:t,onChange:i,numInputs:u,renderSeparator:n.jsx("span",{style:{margin:"0 5px"}}),renderInput:r=>n.jsx("input",{...r,style:{height:"44px",width:"calc(25% - 10px)",textAlign:"center",fontSize:"16px",borderBottom:`1px solid ${C.gray7}`,borderTop:"none",borderLeft:"none",borderRight:"none",background:C.gray}})})};ee.propTypes={otp:H.string.isRequired,setOtp:H.func.isRequired,numInputs:H.number};const Ge={linkStyle:{fontSize:"14px",fontFamily:"Chivo",fontWeight:400,color:C.orange1,mt:1,cursor:"pointer"}},Je=({isVerificationPage:t,setIsVerificationPage:a,email:u,setOtpVerificationLoading:s,setOtpErrorMessage:i})=>{const[r,c]=I.useState(30);I.useEffect(()=>{if(t&&r>0){const g=setTimeout(()=>c(r-1),1e3);return()=>clearTimeout(g)}},[t,r]);const l=async()=>{c(30),i("");try{s(!0),await K({emailId:u})}catch{a(!1)}finally{s(!1)}};return n.jsx(f,{display:"flex",flexDirection:"column",alignItems:"center",children:r>0?n.jsxs(w,{variant:"body1",fontWeight:400,textAlign:"center",children:["You can request another code in ",r,"s"]}):n.jsx(M,{sx:Ge.linkStyle,onClick:l,children:"Resend"})})},Ke=({otp:t,setOtp:a,otpErrorMessage:u,setOtpErrorMessage:s,isVerificationPage:i,setIsVerificationPage:r,email:c})=>{const l=ve(),{userRole:g}=be(),{navigateWithHistory:v}=Ce(),[j,x]=I.useState(!1),p=async()=>{var S,D,L,A,O,B,h,V,b;if(!t){s("Please Enter Valid Otp");return}x(!0);try{const d=await je({emailId:c,otp:parseInt(t,10)});if(((S=d==null?void 0:d.data)==null?void 0:S.status_code)===200){const k=(L=(D=d==null?void 0:d.data)==null?void 0:D.data)==null?void 0:L.user_data,_=(O=(A=d==null?void 0:d.data)==null?void 0:A.data)==null?void 0:O.accessToken;Be("token",_),k.role===U.admin&&l(De(k.company_id)),await Promise.all([l(ke()),l(Ie()),l(we()),l(Se()),l(Le()),l(Pe())]),l(Te(k)),g===U.admin?v(`/admin/resources?tab=${btoa("1")}`,!0):v("/admin",!0)}}catch(d){((h=(B=d==null?void 0:d.response)==null?void 0:B.data)==null?void 0:h.status_code)===400&&s((b=(V=d==null?void 0:d.response)==null?void 0:V.data)==null?void 0:b.data)}finally{x(!1)}};return n.jsxs(f,{mt:4,children:[n.jsx(w,{variant:"body1",fontWeight:300,children:"Enter One Time Password"}),n.jsx(f,{my:1,children:n.jsx(ee,{otp:t,setOtp:a,setOtpErrorMessage:s})}),u&&n.jsx(w,{variant:"body2",color:"error",children:u}),n.jsx(X,{title:j?"Loading...":"Verify",size:"large",disabled:j,sx:{...W.continueBtn,mt:"27px"},onClick:p}),n.jsxs(f,{mt:"37px",display:"flex",justifyContent:"center",flexDirection:"column",children:[n.jsx(w,{variant:"body1",fontWeight:400,textAlign:"center",children:"Didn’t receive verification code?"}),n.jsx(Je,{isVerificationPage:i,setIsVerificationPage:r,email:c,setOtpVerificationLoading:x,setOtpErrorMessage:s})]})]})},it=()=>{const[t,a]=I.useState(""),[u,s]=I.useState(""),[i,r]=I.useState(""),[c,l]=I.useState(!1);return n.jsx(f,{sx:W.mainContainer,children:n.jsx(f,{sx:{...J.centerDivCss,...W.subContainer},children:n.jsx(f,{sx:{...W.wrapper,maxHeight:{xs:"100%",md:c?"704px":"517px"}},children:n.jsxs(qe,{children:[n.jsxs(f,{mt:6.4,sx:{display:"flex",flexDirection:"column",gap:2},children:[n.jsxs(w,{variant:"h3",fontWeight:700,children:[c?"Email":"Login"," ",n.jsx(f,{component:"span",color:C.orange1,children:c?"Verification":"Required."})]}),n.jsxs(f,{children:[n.jsx(w,{variant:"h6",fontWeight:300,fontFamily:"Chivo",children:c?"Please enter OTP that we shared on":" Please enter email id and we will share the OTP with you."}),c&&n.jsxs(f,{display:"flex",alignItems:"center",gap:1,children:[n.jsx(w,{variant:"body1",fontWeight:700,children:t}),n.jsx(f,{component:"img",src:He,sx:{cursor:"pointer"},onClick:()=>l(!1)})]})]})]}),c?n.jsx(Ke,{otp:u,setOtp:s,otpErrorMessage:i,setOtpErrorMessage:r,isVerificationPage:c,setIsVerificationPage:l,email:t}):n.jsx(Ye,{email:t,setEmail:a,setIsVerificationPage:l})]})})})})};export{it as default};

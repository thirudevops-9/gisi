import{n as H,F as k,w as M,a as l,l as V,bc as z,bF as P,bJ as G,j as e,B as s,c as g,bG as _,o as h,T as x,aQ as J,aG as K,b4 as E,aY as Q,bK as R,bL as U}from"./index-BcecFl1Z.js";import{a as Y,b as O,S as X,F as Z,C as ee}from"./SettingsHeader-CQCGcilU.js";import{c as te}from"./companypage-CEeT91cX.js";import{C as ae}from"./CustomTextArea-BvZd_Hkf.js";import{E as u,I as se}from"./ImageDropzone--TLyPGNJ.js";import{u as ie}from"./formik.esm-BY6TlLsT.js";import{c as oe,b as f,d as v,e as re}from"./index.esm-D49cUJoZ.js";import"./Materialcons-Die1CzwC.js";import"./Search-DNIIj65s.js";import"./Tooltip-Ekydzdoo.js";import"./Checkbox-C1UzI-gw.js";import"./CustomButtons-2kTcvzb6.js";import"./index-Cj_J1U08.js";const be=()=>{const w=H(),j=k(),A=M(),[q,S]=l.useState(!1),[L,b]=l.useState(!1),[p,T]=l.useState({studioName:"",description:"",tags:[],studioImage:[]}),[c,W]=l.useState(!1),{tagsFilteredData:$}=V(z),{id:d}=P(),B=oe({studioName:f().required("Studio name is required").min(3,"Studio name should be at least 3 characters long").max(20,"Studio name should be less than 20 characters long"),description:f().required("Description is required").min(10,"Description should be at least 10 characters long").max(250,"Description should be less than 250 characters long"),tags:v().min(1,"At least one tag is required").max(7,"A maximum of 7 tags is allowed").of(f().required("Tag is required")),studioImage:v().min(1,"At least one image is required").of(re().required("Image is required"))}),F=async(a,n,o)=>{var I,D,N;S(!0);const r=new FormData;r.append("studioImage",a.studioImage[0].file),r.append("studioImageName",a.studioImage[0].name),r.append("description",a.description),r.append("studioName",a.studioName),a.tags.forEach((i,m)=>{r.append(`tags[${m}]`,i)});try{const i=await n(r,o&&atob(o));((I=i==null?void 0:i.data)==null?void 0:I.status_code)===200&&(E.success(c?"Studio Updated":"Studio Added"),t.resetForm(),w(Q()))}catch(i){const m=(N=(D=i==null?void 0:i.response)==null?void 0:D.data)==null?void 0:N.data;Array.isArray(m)?m.forEach(C=>{t.setFieldError(C.fieldname,C.message)}):typeof m=="string"&&E.error(m)}finally{S(!1)}},y=l.useCallback(async()=>{if(d){b(!0);try{const a=atob(d),n=await G({id:a});if(n.data.status_code===200){const o=n.data.data.data[0];T({studioName:o.name,tags:o.tags.map(r=>r.value),description:o.description,studioImage:[{file:o.image,name:o.originalFilename}]})}}catch(a){console.error(a)}finally{b(!1)}}},[d]);l.useEffect(()=>{j.pathname.includes("edit")&&(d?(W(!0),y()):A(-1))},[j,d,y]);const t=ie({initialValues:p,validationSchema:B,onSubmit:a=>{c&&d?F(a,R,d):F(a,U)}});return l.useEffect(()=>{t.resetForm({values:p})},[p]),e.jsxs(s,{bgcolor:g.white2,borderTop:"1px solid white",children:[L&&e.jsx(_,{}),e.jsx(Y,{}),e.jsx(s,{sx:{...h.initialMainComponet,...h.cmsWrapperCss,mx:"auto",minHeight:"100vh"},children:e.jsxs("form",{onSubmit:t.handleSubmit,children:[e.jsx(s,{mb:2.6,children:e.jsx(O,{loading:q,update:c,title:e.jsxs(x,{variant:"h4",fontWeight:700,children:[" ",e.jsx(x,{component:"span",variant:"h4",fontWeight:700,sx:{color:g.orange1},children:c?"Edit":"Add"})," ","Studio"]})})}),e.jsx(X,{children:e.jsxs(s,{display:"flex",sx:{maxWidth:"755px",minHeight:"70vh",mx:"auto"},children:[e.jsx(s,{width:"60px"}),e.jsxs(s,{sx:{flex:1},children:[e.jsx(Z,{title:"Studio details",imageSrc:te,imgHeight:"106",description:"Company titles and images - will be showcased as such",tooltip:!1}),e.jsxs(s,{mt:"44px",children:[e.jsx(J,{maxLength:20,value:t.values.studioName,onChange:a=>{t.setFieldValue("studioName",a==null?void 0:a.target.value)},placeholder:"Studio Name",border:"none",fontSize:"24px",placeholderFontSize:"24px",placeholderFontWeight:400,placeholderFontFamily:"Noto Serif",borderBottom:`1px solid ${g.gray2}`,sx:{width:"100%"}}),t.touched.studioName&&t.errors.studioName&&e.jsx(s,{children:e.jsx(u,{message:t.errors.studioName})})]}),e.jsxs(s,{mt:"32px",children:[e.jsx(ee,{placeholder:"Add tags",formik:t,fieldName:"tags",options:$}),t.touched.tags&&t.errors.tags&&e.jsx(s,{children:e.jsx(u,{message:t.errors.tags})})]}),e.jsx(s,{mt:"32px",mb:"180px",children:e.jsxs(K,{fullWidth:!0,children:[e.jsx(ae,{maxLength:250,value:t.values.description,handleChange:a=>{var n;a.preventDefault(),t.setFieldValue("description",(n=a==null?void 0:a.target)==null?void 0:n.value)},placeholder:"Type your description here"}),t.touched.description&&t.errors.description&&e.jsx(s,{children:e.jsx(u,{message:t.errors.description})})]})}),e.jsxs(s,{children:[e.jsx(se,{isEdit:!1,formik:t,fieldName:"studioImage",imgLimit:1}),t.touched.studioImage&&t.errors.studioImage&&e.jsx(s,{children:e.jsx(u,{message:t.errors.studioImage})})]})]}),e.jsx(s,{width:"60px",children:e.jsx(x,{mt:{xs:29,md:30.5},variant:"body2",sx:h.maxLimitTypo,children:"250 Max"})})]})})]})})]})};export{be as default};
